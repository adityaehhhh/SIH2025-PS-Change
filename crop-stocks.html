<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>By-Product Price Dashboard</title>
    <style>
        /* General Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Light Mode Theme Colors:
         * Primary: #007BFF (Blue for emphasis/links)
         * Accent: #28a745 (Green for positive stats/buttons)
         * Background: #f8f9fa (Very light gray)
         * Card/Control Background: #ffffff (White)
         * Text: #343a40 (Dark gray/black)
         * Border/Shadow: #e9ecef (Light border)
        */

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8f9fa; /* Light background */
            color: #343a40; /* Dark text for contrast */
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header Styles */
        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            color: #007BFF; /* Primary accent color */
            margin-bottom: 10px;
            text-shadow: none; /* Removed dark mode shadow */
        }

        .header p {
            color: #6c757d; /* Muted text color */
            font-size: 1.1rem;
        }

        /* Controls Section Styles */
        .controls {
            background: #ffffff; /* White background for light mode card */
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08); /* Subtle light shadow */
        }

        .control-group {
            display: grid;
            /* **Responsiveness improvement:** Changed minmax(300px, 1fr) to minmax(280px, 1fr) for slightly better fit on mid-sized mobiles in landscape. */
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .control-item {
            display: flex;
            flex-direction: column;
        }

        label {
            font-size: 0.9rem;
            color: #007BFF; /* Primary accent color for labels */
            margin-bottom: 8px;
            font-weight: 600;
        }

        select {
            padding: 12px;
            border: 1px solid #ced4da; /* Light border */
            border-radius: 8px;
            background: #ffffff;
            color: #495057; /* Darker text for input fields */
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        select:hover {
            border-color: #007BFF;
        }

        select:focus {
            outline: none;
            border-color: #007BFF;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.25); /* Subtle focus shadow */
        }

        /* Chart Container Styles */
        .chart-container {
            background: #ffffff; /* White background for the chart area */
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .chart-title {
            font-size: 1.5rem;
            color: #343a40; /* Standard dark text */
            font-weight: 600;
        }

        .chart-type-selector {
            display: flex;
            gap: 10px;
        }

        .chart-type-btn {
            padding: 8px 16px;
            background: #f1f1f1; /* Light button background */
            border: 1px solid #ced4da;
            border-radius: 6px;
            color: #343a40;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .chart-type-btn:hover {
            background: #e9ecef;
            border-color: #007BFF;
        }

        .chart-type-btn.active {
            background: #28a745; /* Green accent color */
            border-color: #28a745;
            color: #ffffff; /* White text on active button */
            font-weight: 600;
        }

        /* Canvas Style - Note: Actual chart drawing colors are updated in JavaScript */
        #priceChart {
            width: 100%;
            height: 400px;
            background: #f8f9fa; /* Light background for chart area */
            border-radius: 8px;
            position: relative;
            border: 1px solid #e9ecef;
        }

        /* Stats Container Styles */
        .stats-container {
            display: grid;
            /* **Responsiveness improvement:** Adjusted minmax for better layout on mid-screens. */
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: #ffffff; /* White card background */
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            border-left: 4px solid;
            transition: transform 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.1);
        }

        /* Stat Card Colors */
        .stat-card.current {
            border-left-color: #007BFF; /* Blue */
        }

        .stat-card.highest {
            border-left-color: #dc3545; /* Red (Danger) */
        }

        .stat-card.lowest {
            border-left-color: #28a745; /* Green (Success) */
        }

        .stat-label {
            font-size: 0.9rem;
            color: #6c757d; /* Muted text */
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 500;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
            color: #343a40; /* Default value color */
        }

        /* Stat Value Colors */
        .stat-card.current .stat-value {
            color: #007BFF;
        }

        .stat-card.highest .stat-value {
            color: #dc3545;
        }

        .stat-card.lowest .stat-value {
            color: #28a745;
        }

        .stat-change {
            font-size: 0.85rem;
            color: #6c757d;
        }

        /* Demand Section Styles */
        .demand-section {
            background: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        .demand-title {
            font-size: 1.5rem;
            color: #343a40;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .demand-list {
            display: grid;
            /* **Responsiveness improvement:** Smaller minmax for better tile packing on larger screens. */
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); 
            gap: 15px;
        }

        .demand-item {
            background: #f8f9fa; /* Very light background for items */
            padding: 15px;
            border-radius: 8px;
            border-left: 3px solid #007BFF;
            transition: transform 0.3s;
        }

        .demand-item:hover {
            transform: translateY(-3px);
            background: #e9ecef;
        }

        .demand-name {
            font-size: 1rem;
            color: #343a40;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .demand-percentage {
            font-size: 0.85rem;
            color: #28a745; /* Green percentage */
            font-weight: 600;
        }
        
        /* ======================================================================= */
        /* RESPONSIVENESS (Media Queries)                   */
        /* ======================================================================= */

        /* Tablet/Small Desktop (992px) - Minor adjustments */
        @media (max-width: 992px) {
            .container {
                padding: 0 10px;
            }

            .control-group {
                /* Allows the two select boxes to stack slightly sooner if necessary, but keeps the flow. */
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            }

            .stats-container {
                /* Can remain flexible, but ensures at least 2 columns on most tablets. */
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
        }

        /* Mobile (768px) - Stacking layout */
        @media (max-width: 768px) {
            body {
                padding: 15px;
            }

            .header h1 {
                font-size: 2rem;
            }
            
            .header p {
                font-size: 1rem;
            }

            .chart-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .chart-type-selector {
                margin-top: 10px;
                width: 100%;
                justify-content: space-between;
            }
            
            .chart-type-btn {
                flex-grow: 1; /* Makes buttons fill space */
                text-align: center;
            }

            .control-group {
                grid-template-columns: 1fr; /* Stacks controls vertically on mobile */
            }

            .stats-container {
                grid-template-columns: 1fr; /* Stacks stat cards vertically on mobile */
            }

            #priceChart {
                height: 300px; /* Reduced height for smaller screens */
            }

            .demand-list {
                /* Allows for 2 columns of demand items on most mobiles */
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); 
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸŒ¾ By-Product Price Dashboard</h1>
            <p>Real-time market prices for oilseed by-products</p>
        </div>

        <div class="controls">
            <div class="control-group">
                <div class="control-item">
                    <label for="oilseedSelect">Select Oilseed Type</label>
                    <select id="oilseedSelect">
                        <option value="">-- Choose Oilseed --</option>
                    </select>
                </div>
                <div class="control-item">
                    <label for="byproductSelect">Select By-Product</label>
                    <select id="byproductSelect">
                        <option value="">-- First Select Oilseed --</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="chart-container">
            <div class="chart-header">
                <div class="chart-title">Price Trend Analysis</div>
                <div class="chart-type-selector">
                    <button class="chart-type-btn active" data-type="price">Price</button>
                    <button class="chart-type-btn" data-type="demand">Demand</button>
                    <button class="chart-type-btn" data-type="supply">Supply</button>
                </div>
            </div>
            <canvas id="priceChart"></canvas>
        </div>

        <div class="stats-container">
            <div class="stat-card current">
                <div class="stat-label">Current Price</div>
                <div class="stat-value" id="currentPrice">â‚¹0</div>
                <div class="stat-change" id="currentChange">Per Quintal</div>
            </div>
            <div class="stat-card highest">
                <div class="stat-label">Highest Price (30 Days)</div>
                <div class="stat-value" id="highestPrice">â‚¹0</div>
                <div class="stat-change" id="highestChange">Peak Value</div>
            </div>
            <div class="stat-card lowest">
                <div class="stat-label">Lowest Price (30 Days)</div>
                <div class="stat-value" id="lowestPrice">â‚¹0</div>
                <div class="stat-change" id="lowestChange">Minimum Value</div>
            </div>
        </div>

        <div class="demand-section">
            <div class="demand-title">Primary Demand Sources</div>
            <div class="demand-list" id="demandList">
                <p style="color: #6c757d; font-style: italic;">Select an oilseed and by-product to view demand sources</p>
            </div>
        </div>
    </div>

    <script>
        // Comprehensive Oilseed Database with By-Products and Market Data (Kept the same)
        const oilseedData = {
            "Soybean": {
                byproducts: {
                    "Soybean Meal (44% Protein)": { basePrice: 3200, volatility: 150, demand: ["Poultry Farms", "Cattle Feed Mills", "Aquaculture", "Pet Food Industry", "Organic Fertilizer Companies"] },
                    "Soybean Meal (48% Protein)": { basePrice: 3500, volatility: 180, demand: ["Premium Poultry Feed", "Export Markets", "Animal Nutrition Companies", "Livestock Farms"] },
                    "Soybean Cake": { basePrice: 2800, volatility: 120, demand: ["Small Dairy Farms", "Local Feed Suppliers", "Organic Farms"] },
                    "Soy Hulls": { basePrice: 800, volatility: 60, demand: ["Biomass Energy Plants", "Mushroom Cultivation", "Compost Producers", "Particle Board Manufacturers"] },
                    "Soy Lecithin": { basePrice: 12000, volatility: 500, demand: ["Food Processing Companies", "Pharmaceutical Industry", "Cosmetics Manufacturers", "Chocolate Industry"] },
                    "Soy Protein Concentrate": { basePrice: 8500, volatility: 400, demand: ["Health Food Companies", "Protein Supplement Brands", "Meat Alternatives", "Bakery Industry"] },
                    "Soy Protein Isolate": { basePrice: 15000, volatility: 700, demand: ["Sports Nutrition Brands", "Infant Formula", "Medical Nutrition", "Vegan Products"] },
                    "Textured Vegetable Protein": { basePrice: 6000, volatility: 300, demand: ["Meat Substitute Companies", "Vegan Food Brands", "School Lunch Programs"] },
                    "Soapstock": { basePrice: 1500, volatility: 100, demand: ["Soap Manufacturers", "Biodiesel Producers", "Industrial Chemicals"] }
                }
            },
            "Groundnut": {
                byproducts: {
                    "Groundnut Meal": { basePrice: 2400, volatility: 120, demand: ["Poultry Feed", "Cattle Feed", "Fish Feed", "Pet Food"] },
                    "Groundnut Cake": { basePrice: 2200, volatility: 110, demand: ["Dairy Farms", "Goat Farms", "Organic Fertilizer"] },
                    "Peanut Shells": { basePrice: 400, volatility: 40, demand: ["Biofuel Plants", "Mushroom Growers", "Particle Board", "Cat Litter Manufacturers"] },
                    "Peanut Hulls": { basePrice: 300, volatility: 30, demand: ["Biomass Pellets", "Animal Bedding", "Mulch Producers"] },
                    "Peanut Skins": { basePrice: 600, volatility: 50, demand: ["Antioxidant Extraction", "Cosmetics Industry", "Natural Dyes"] }
                }
            },
            "Sunflower": {
                byproducts: {
                    "Sunflower Meal (28% Protein)": { basePrice: 1800, volatility: 90, demand: ["Cattle Feed", "Sheep Feed", "Goat Feed"] },
                    "Sunflower Meal (36% Protein)": { basePrice: 2100, volatility: 110, demand: ["Poultry Feed", "Pig Feed", "Horse Feed"] },
                    "Sunflower Cake": { basePrice: 1600, volatility: 80, demand: ["Small Farms", "Dairy Cooperatives", "Organic Farms"] },
                    "Sunflower Hulls": { basePrice: 350, volatility: 35, demand: ["Biofuel Briquettes", "Compost Industry", "Mulch", "Animal Bedding"] },
                    "Sunflower Husk": { basePrice: 300, volatility: 30, demand: ["Biomass Energy", "Pellet Production", "Board Manufacturing"] }
                }
            },
            "Rapeseed": {
                byproducts: {
                    "Rapeseed Meal": { basePrice: 2000, volatility: 100, demand: ["Cattle Feed", "Pig Feed", "Aquaculture"] },
                    "Canola Meal": { basePrice: 2200, volatility: 120, demand: ["Poultry Feed", "Export Markets", "Livestock"] },
                    "Rapeseed Cake": { basePrice: 1800, volatility: 90, demand: ["Dairy Farms", "Beef Cattle", "Fertilizer"] },
                    "Rapeseed Hulls": { basePrice: 400, volatility: 40, demand: ["Biofuel", "Compost", "Animal Bedding"] }
                }
            },
            "Mustard": {
                byproducts: {
                    "Mustard Cake": { basePrice: 1600, volatility: 80, demand: ["Organic Fertilizer", "Fish Pond Treatment", "Biopesticide", "Nematode Control"] },
                    "Mustard Meal": { basePrice: 1400, volatility: 70, demand: ["Cattle Feed", "Goat Feed", "Soil Amendment"] },
                    "De-oiled Mustard Cake": { basePrice: 1200, volatility: 60, demand: ["Organic Farms", "Kitchen Garden", "Nurseries"] },
                    "Mustard Husk": { basePrice: 250, volatility: 25, demand: ["Biomass", "Compost", "Mulch"] }
                }
            },
            "Cottonseed": {
                byproducts: {
                    "Cottonseed Meal": { basePrice: 2600, volatility: 130, demand: ["Cattle Feed", "Dairy Farms", "Goat Farms"] },
                    "Cottonseed Cake": { basePrice: 2400, volatility: 120, demand: ["Livestock Feed", "Organic Fertilizer"] },
                    "Cottonseed Hulls": { basePrice: 600, volatility: 50, demand: ["Cattle Feed", "Mushroom Substrate", "Mulch"] },
                    "Cotton Linters": { basePrice: 8000, volatility: 400, demand: ["Paper Industry", "Explosives", "Cushion Filling", "Currency Paper"] }
                }
            },
            "Palm Kernel": {
                byproducts: {
                    "Palm Kernel Meal": { basePrice: 1500, volatility: 80, demand: ["Cattle Feed", "Poultry Feed", "Aquaculture"] },
                    "Palm Kernel Expeller": { basePrice: 1600, volatility: 85, demand: ["Animal Feed", "Export Markets"] },
                    "Palm Kernel Shell": { basePrice: 800, volatility: 60, demand: ["Activated Carbon", "Biofuel", "Charcoal Briquettes"] }
                }
            },
            "Copra": {
                byproducts: {
                    "Copra Meal": { basePrice: 1800, volatility: 90, demand: ["Cattle Feed", "Poultry Feed", "Pet Food"] },
                    "Coconut Meal": { basePrice: 1700, volatility: 85, demand: ["Livestock", "Aquaculture", "Organic Feed"] },
                    "Coconut Shell": { basePrice: 1200, volatility: 80, demand: ["Activated Carbon", "Handicrafts", "Charcoal"] },
                    "Coconut Husk": { basePrice: 400, volatility: 40, demand: ["Coir Industry", "Growing Medium", "Erosion Control"] }
                }
            },
            "Sesame": {
                byproducts: {
                    "Sesame Meal": { basePrice: 3000, volatility: 150, demand: ["Premium Animal Feed", "Poultry", "Health Supplements"] },
                    "Sesame Cake": { basePrice: 2800, volatility: 140, demand: ["Livestock", "Organic Farms", "Fertilizer"] },
                    "Sesame Hulls": { basePrice: 500, volatility: 50, demand: ["Biomass", "Compost", "Mulch"] }
                }
            },
            "Linseed": {
                byproducts: {
                    "Linseed Meal": { basePrice: 2500, volatility: 125, demand: ["Cattle Feed", "Omega-3 Supplements", "Health Food"] },
                    "Linseed Cake": { basePrice: 2300, volatility: 115, demand: ["Dairy Farms", "Livestock", "Organic Feed"] },
                    "Flax Hulls": { basePrice: 400, volatility: 40, demand: ["Dietary Fiber", "Biomass", "Compost"] }
                }
            },
            "Safflower": {
                byproducts: {
                    "Safflower Meal": { basePrice: 1600, volatility: 80, demand: ["Poultry Feed", "Cattle Feed"] },
                    "Safflower Cake": { basePrice: 1400, volatility: 70, demand: ["Animal Feed", "Bird Seed Mix"] },
                    "Safflower Hulls": { basePrice: 300, volatility: 30, demand: ["Biomass", "Mulch"] }
                }
            },
            "Castor": {
                byproducts: {
                    "Castor Meal (Detoxified)": { basePrice: 1200, volatility: 80, demand: ["Organic Fertilizer", "Biopesticide", "Nematicide"] },
                    "Castor Cake": { basePrice: 1000, volatility: 70, demand: ["Organic Farms", "Soil Amendment"] },
                    "Castor Hulls": { basePrice: 200, volatility: 20, demand: ["Biomass", "Compost"] }
                }
            },
            "Niger Seed": {
                byproducts: {
                    "Niger Seed Meal": { basePrice: 1800, volatility: 90, demand: ["Bird Feed", "Cattle Feed", "Poultry"] },
                    "Niger Cake": { basePrice: 1600, volatility: 80, demand: ["Animal Feed", "Livestock"] },
                    "Niger Seed Hulls": { basePrice: 300, volatility: 30, demand: ["Biomass", "Mulch"] }
                }
            },
            "Black Seed": {
                byproducts: {
                    "Black Seed Meal": { basePrice: 8000, volatility: 400, demand: ["Health Supplements", "Herbal Medicine", "Cosmetics"] },
                    "Nigella Cake": { basePrice: 7000, volatility: 350, demand: ["Nutraceuticals", "Traditional Medicine"] }
                }
            },
            "Babassu": {
                byproducts: {
                    "Babassu Meal": { basePrice: 1400, volatility: 70, demand: ["Animal Feed", "Biofuel"] },
                    "Babassu Cake": { basePrice: 1200, volatility: 60, demand: ["Livestock", "Biomass"] },
                    "Babassu Shell": { basePrice: 800, volatility: 60, demand: ["Charcoal", "Activated Carbon"] }
                }
            },
            "Shea Nut": {
                byproducts: {
                    "Shea Nut Meal": { basePrice: 2000, volatility: 100, demand: ["Animal Feed", "Fertilizer"] },
                    "Shea Nut Cake": { basePrice: 1800, volatility: 90, demand: ["Livestock", "Organic Farms"] }
                }
            },
            "Perilla": {
                byproducts: {
                    "Perilla Meal": { basePrice: 3500, volatility: 175, demand: ["Health Food", "Omega-3 Supplements"] },
                    "Perilla Cake": { basePrice: 3200, volatility: 160, demand: ["Premium Feed", "Nutraceuticals"] }
                }
            },
            "Hemp": {
                byproducts: {
                    "Hemp Seed Meal": { basePrice: 4000, volatility: 200, demand: ["Health Food", "Protein Supplements", "Animal Feed"] },
                    "Hemp Seed Cake": { basePrice: 3800, volatility: 190, demand: ["Organic Feed", "Vegan Products"] },
                    "Hemp Hulls": { basePrice: 1000, volatility: 80, demand: ["Animal Bedding", "Mulch"] }
                }
            },
            "Poppy": {
                byproducts: {
                    "Poppy Seed Meal": { basePrice: 3000, volatility: 150, demand: ["Bakery Industry", "Health Food"] },
                    "Poppy Seed Cake": { basePrice: 2800, volatility: 140, demand: ["Food Processing", "Animal Feed"] }
                }
            },
            "Chia": {
                byproducts: {
                    "Chia Seed Meal": { basePrice: 6000, volatility: 300, demand: ["Health Food", "Smoothie Industry", "Bakery"] },
                    "De-oiled Chia Cake": { basePrice: 5500, volatility: 275, demand: ["Protein Supplements", "Vegan Products"] }
                }
            },
            "Amaranth": {
                byproducts: {
                    "Amaranth Meal": { basePrice: 4500, volatility: 225, demand: ["Gluten-Free Products", "Health Food", "Bakery"] },
                    "Amaranth Cake": { basePrice: 4200, volatility: 210, demand: ["Nutrition Bars", "Cereals"] }
                }
            },
            "Camelina": {
                byproducts: {
                    "Camelina Meal": { basePrice: 2200, volatility: 110, demand: ["Animal Feed", "Aquaculture", "Biofuel"] },
                    "Camelina Cake": { basePrice: 2000, volatility: 100, demand: ["Livestock", "Omega-3 Supplements"] }
                }
            },
            "Jatropha": {
                byproducts: {
                    "Jatropha Meal (Detoxified)": { basePrice: 800, volatility: 60, demand: ["Organic Fertilizer", "Biopesticide"] },
                    "Jatropha Cake": { basePrice: 600, volatility: 50, demand: ["Biofuel", "Soil Amendment"] }
                }
            },
            "Tung": {
                byproducts: {
                    "Tung Meal": { basePrice: 1000, volatility: 70, demand: ["Industrial Applications", "Wood Finish"] },
                    "Tung Cake": { basePrice: 800, volatility: 60, demand: ["Biofuel", "Industrial Chemicals"] }
                }
            },
            "Crambe": {
                byproducts: {
                    "Crambe Meal": { basePrice: 1500, volatility: 75, demand: ["Animal Feed", "Industrial Oil"] },
                    "Crambe Cake": { basePrice: 1300, volatility: 65, demand: ["Livestock", "Biofuel"] }
                }
            },
            "Borage": {
                byproducts: {
                    "Borage Meal": { basePrice: 5000, volatility: 250, demand: ["Health Supplements", "Cosmetics", "Anti-inflammatory"] },
                    "Borage Cake": { basePrice: 4800, volatility: 240, demand: ["Nutraceuticals", "Skin Care"] }
                }
            },
            "Evening Primrose": {
                byproducts: {
                    "Evening Primrose Meal": { basePrice: 7000, volatility: 350, demand: ["Health Supplements", "Cosmetics", "Pharmaceuticals"] },
                    "Evening Primrose Cake": { basePrice: 6500, volatility: 325, demand: ["Women's Health Products", "Skin Care"] }
                }
            },
            "Calendula": {
                byproducts: {
                    "Calendula Meal": { basePrice: 6000, volatility: 300, demand: ["Cosmetics", "Herbal Medicine", "Skin Care"] },
                    "Calendula Cake": { basePrice: 5500, volatility: 275, demand: ["Natural Products", "Healing Creams"] }
                }
            },
            "Neem": {
                byproducts: {
                    "Neem Cake": { basePrice: 1400, volatility: 70, demand: ["Organic Fertilizer", "Biopesticide", "Nematicide", "Soil Conditioner"] },
                    "Neem Meal": { basePrice: 1200, volatility: 60, demand: ["Organic Farms", "Kitchen Gardens", "Plant Nurseries"] },
                    "De-oiled Neem Cake": { basePrice: 1000, volatility: 50, demand: ["Fertilizer", "Pest Control"] }
                }
            },
            "Karanja": {
                byproducts: {
                    "Karanja Cake": { basePrice: 1600, volatility: 80, demand: ["Biopesticide", "Organic Fertilizer", "Fish Farms"] },
                    "Pongamia Meal": { basePrice: 1400, volatility: 70, demand: ["Soil Amendment", "Pest Control"] }
                }
            },
            "Mahua": {
                byproducts: {
                    "Mahua Cake": { basePrice: 1000, volatility: 60, demand: ["Organic Fertilizer", "Fish Farming", "Ethanol Production"] },
                    "Mahua De-oiled Cake": { basePrice: 800, volatility: 50, demand: ["Fertilizer", "Aquaculture"] }
                }
            },
            "Kokum": {
                byproducts: {
                    "Kokum Seed Meal": { basePrice: 3000, volatility: 150, demand: ["Cosmetics", "Pharmaceuticals"] },
                    "Kokum Seed Cake": { basePrice: 2800, volatility: 140, demand: ["Skin Care", "Health Products"] }
                }
            },
            "Sal": {
                byproducts: {
                    "Sal Seed Cake": { basePrice: 1200, volatility: 60, demand: ["Animal Feed", "Biofuel"] },
                    "Sal Seed Meal": { basePrice: 1000, volatility: 50, demand: ["Livestock", "Biomass"] }
                }
            },
            "Olive": {
                byproducts: {
                    "Olive Pomace Meal": { basePrice: 2500, volatility: 125, demand: ["Animal Feed", "Cosmetics"] },
                    "Olive Pit": { basePrice: 800, volatility: 60, demand: ["Biomass Fuel", "Activated Carbon"] }
                }
            },
            "Tallow Tree": {
                byproducts: {
                    "Tallow Seed Meal": { basePrice: 1500, volatility: 75, demand: ["Biodiesel", "Soap Making"] },
                    "Tallow Seed Cake": { basePrice: 1300, volatility: 65, demand: ["Industrial Applications"] }
                }
            },
            "Brazil Nut": {
                byproducts: {
                    "Brazil Nut Meal": { basePrice: 8000, volatility: 400, demand: ["Premium Food Products", "Cosmetics"] },
                    "Brazil Nut Cake": { basePrice: 7500, volatility: 375, demand: ["Health Food", "Skin Care"] }
                }
            },
            "Macadamia": {
                byproducts: {
                    "Macadamia Nut Meal": { basePrice: 12000, volatility: 600, demand: ["Premium Cosmetics", "Health Food"] },
                    "Macadamia Cake": { basePrice: 11000, volatility: 550, demand: ["Luxury Products", "Skin Care"] }
                }
            },
            "Walnut": {
                byproducts: {
                    "Walnut Meal": { basePrice: 6000, volatility: 300, demand: ["Health Food", "Bakery", "Cosmetics"] },
                    "Walnut Cake": { basePrice: 5500, volatility: 275, demand: ["Food Industry", "Protein Supplements"] },
                    "Walnut Shell": { basePrice: 1500, volatility: 100, demand: ["Abrasives", "Activated Carbon", "Cosmetics Scrubs"] }
                }
            },
            "Almond": {
                byproducts: {
                    "Almond Meal": { basePrice: 15000, volatility: 750, demand: ["Premium Bakery", "Gluten-Free Products", "Cosmetics"] },
                    "Almond Cake": { basePrice: 14000, volatility: 700, demand: ["Health Food", "Protein Bars", "Skin Care"] },
                    "Almond Shell": { basePrice: 800, volatility: 60, demand: ["Biomass", "Garden Mulch", "Animal Bedding"] }
                }
            },
            "Hazelnut": {
                byproducts: {
                    "Hazelnut Meal": { basePrice: 10000, volatility: 500, demand: ["Chocolate Industry", "Bakery", "Confectionery"] },
                    "Hazelnut Cake": { basePrice: 9000, volatility: 450, demand: ["Premium Food Products", "Health Supplements"] },
                    "Hazelnut Shell": { basePrice: 600, volatility: 50, demand: ["Biomass", "Activated Carbon", "Garden Products"] }
                }
            },
            "Pistachio": {
                byproducts: {
                    "Pistachio Meal": { basePrice: 18000, volatility: 900, demand: ["Premium Bakery", "Ice Cream Industry", "Confectionery"] },
                    "Pistachio Cake": { basePrice: 16000, volatility: 800, demand: ["Luxury Food Products", "Health Food"] },
                    "Pistachio Shell": { basePrice: 1000, volatility: 80, demand: ["Natural Dyes", "Handicrafts", "Garden Mulch"] }
                }
            },
            "Pecan": {
                byproducts: {
                    "Pecan Meal": { basePrice: 12000, volatility: 600, demand: ["Premium Bakery", "Health Food", "Protein Products"] },
                    "Pecan Cake": { basePrice: 11000, volatility: 550, demand: ["Confectionery", "Ice Cream", "Snacks"] },
                    "Pecan Shell": { basePrice: 800, volatility: 60, demand: ["Mulch", "Biomass", "Garden Products"] }
                }
            },
            "Argan": {
                byproducts: {
                    "Argan Seed Meal": { basePrice: 20000, volatility: 1000, demand: ["Luxury Cosmetics", "Premium Skin Care", "Hair Care"] },
                    "Argan Cake": { basePrice: 18000, volatility: 900, demand: ["Anti-Aging Products", "Health Supplements"] },
                    "Argan Shell": { basePrice: 2000, volatility: 150, demand: ["Biomass", "Activated Carbon", "Exfoliants"] }
                }
            },
            "Tamanu": {
                byproducts: {
                    "Tamanu Seed Meal": { basePrice: 15000, volatility: 750, demand: ["Pharmaceutical", "Wound Healing", "Skin Care"] },
                    "Tamanu Cake": { basePrice: 14000, volatility: 700, demand: ["Medical Cosmetics", "Natural Medicine"] }
                }
            },
            "Moringa": {
                byproducts: {
                    "Moringa Seed Cake": { basePrice: 5000, volatility: 250, demand: ["Water Purification", "Organic Fertilizer", "Animal Feed"] },
                    "Moringa Seed Meal": { basePrice: 4500, volatility: 225, demand: ["Health Supplements", "Nutritional Products"] }
                }
            },
            "Inca Inchi": {
                byproducts: {
                    "Inca Inchi Meal": { basePrice: 8000, volatility: 400, demand: ["Omega-3 Supplements", "Health Food", "Vegan Protein"] },
                    "Sacha Inchi Cake": { basePrice: 7500, volatility: 375, demand: ["Premium Nutrition", "Sports Supplements"] }
                }
            },
            "Marula": {
                byproducts: {
                    "Marula Seed Meal": { basePrice: 10000, volatility: 500, demand: ["Premium Cosmetics", "Anti-Aging Products", "Hair Care"] },
                    "Marula Cake": { basePrice: 9000, volatility: 450, demand: ["Luxury Skin Care", "Natural Beauty Products"] }
                }
            },
            "Baobab": {
                byproducts: {
                    "Baobab Seed Meal": { basePrice: 6000, volatility: 300, demand: ["Health Supplements", "Nutritional Products", "Cosmetics"] },
                    "Baobab Cake": { basePrice: 5500, volatility: 275, demand: ["Vitamin C Supplements", "Skin Care"] }
                }
            }
        };

        // Chart variables
        let chart = null; // Unused in this vanilla canvas implementation but kept for clarity
        let currentChartType = 'price';
        let selectedOilseed = null;
        let selectedByproduct = null;
        let historicalData = [];
        
        // --- Light Mode Chart Colors (Used in updateChart/drawEmptyChart functions) ---
        const LM_CHART_BG = '#f8f9fa';
        const LM_GRID_COLOR = '#ced4da';
        const LM_LABEL_COLOR = '#6c757d';
        const LM_TITLE_COLOR = '#343a40';

        // Initialize the application
        function init() {
            populateOilseedDropdown();
            setupEventListeners();
            drawEmptyChart();
        }

        // Populate oilseed dropdown (Same logic)
        function populateOilseedDropdown() {
            const select = document.getElementById('oilseedSelect');
            const oilseeds = Object.keys(oilseedData).sort();
            
            oilseeds.forEach(oilseed => {
                const option = document.createElement('option');
                option.value = oilseed;
                option.textContent = oilseed;
                select.appendChild(option);
            });
        }

        // Setup event listeners (Same logic)
        function setupEventListeners() {
            document.getElementById('oilseedSelect').addEventListener('change', handleOilseedChange);
            document.getElementById('byproductSelect').addEventListener('change', handleByproductChange);
            
            document.querySelectorAll('.chart-type-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.chart-type-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentChartType = this.dataset.type;
                    if (selectedOilseed && selectedByproduct) {
                        updateChart();
                    }
                });
            });
        }

        // Handle oilseed selection (Same logic)
        function handleOilseedChange(e) {
            selectedOilseed = e.target.value;
            const byproductSelect = document.getElementById('byproductSelect');
            byproductSelect.innerHTML = '<option value="">-- Select By-Product --</option>';
            
            if (selectedOilseed) {
                const byproducts = Object.keys(oilseedData[selectedOilseed].byproducts).sort();
                byproducts.forEach(byproduct => {
                    const option = document.createElement('option');
                    option.value = byproduct;
                    option.textContent = byproduct;
                    byproductSelect.appendChild(option);
                });
            }
            
            selectedByproduct = null;
            resetStats();
        }

        // Handle byproduct selection (Same logic)
        function handleByproductChange(e) {
            selectedByproduct = e.target.value;
            if (selectedByproduct && selectedOilseed) {
                generateHistoricalData();
                updateStats();
                updateDemandList();
                updateChart();
            } else {
                resetStats();
            }
        }

        // Generate historical data (Same logic)
        function generateHistoricalData() {
            const data = oilseedData[selectedOilseed].byproducts[selectedByproduct];
            historicalData = [];
            
            const today = new Date();
            for (let i = 29; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                
                // Generate realistic price fluctuation
                const randomChange = (Math.random() - 0.5) * data.volatility;
                const price = Math.round(data.basePrice + randomChange);
                
                // Generate demand and supply percentages
                const demand = Math.round(50 + (Math.random() - 0.5) * 30);
                const supply = Math.round(50 + (Math.random() - 0.5) * 30);
                
                historicalData.push({
                    date: date.toLocaleDateString('en-IN', { day: '2-digit', month: 'short' }),
                    price: price,
                    demand: demand,
                    supply: supply
                });
            }
        }

        // Update statistics (Same logic)
        function updateStats() {
            const prices = historicalData.map(d => d.price);
            const currentPrice = prices[prices.length - 1];
            const highestPrice = Math.max(...prices);
            const lowestPrice = Math.min(...prices);
            
            document.getElementById('currentPrice').textContent = `â‚¹${currentPrice.toLocaleString('en-IN')}`;
            document.getElementById('highestPrice').textContent = `â‚¹${highestPrice.toLocaleString('en-IN')}`;
            document.getElementById('lowestPrice').textContent = `â‚¹${lowestPrice.toLocaleString('en-IN')}`;
            
            const avgPrice = Math.round(prices.reduce((a, b) => a + b, 0) / prices.length);
            const percentChange = ((currentPrice - avgPrice) / avgPrice * 100).toFixed(1);
            
            // Note: The original code's way of getting the highest/lowest date is technically flawed if multiple days share the max/min, but it's acceptable for a mock dashboard.
            const highestDateIndex = prices.indexOf(highestPrice);
            const lowestDateIndex = prices.indexOf(lowestPrice);
            
            document.getElementById('currentChange').textContent = `${percentChange > 0 ? '+' : ''}${percentChange}% vs 30-day avg`;
            document.getElementById('highestChange').textContent = `Peak on ${historicalData[highestDateIndex].date}`;
            document.getElementById('lowestChange').textContent = `Low on ${historicalData[lowestDateIndex].date}`;
        }

        // Update demand list (Slight style update for <p> tag)
        function updateDemandList() {
            const demandList = document.getElementById('demandList');
            const demandSources = oilseedData[selectedOilseed].byproducts[selectedByproduct].demand;
            
            demandList.innerHTML = '';
            demandSources.forEach(source => {
                const percentage = Math.round(15 + Math.random() * 25);
                const item = document.createElement('div');
                item.className = 'demand-item';
                item.innerHTML = `
                    <div class="demand-name">${source}</div>
                    <div class="demand-percentage">${percentage}% Market Share</div>
                `;
                demandList.appendChild(item);
            });
        }

        // Reset statistics (Slight style update for <p> tag)
        function resetStats() {
            document.getElementById('currentPrice').textContent = 'â‚¹0';
            document.getElementById('highestPrice').textContent = 'â‚¹0';
            document.getElementById('lowestPrice').textContent = 'â‚¹0';
            document.getElementById('currentChange').textContent = 'Per Quintal';
            document.getElementById('highestChange').textContent = 'Peak Value';
            document.getElementById('lowestChange').textContent = 'Minimum Value';
            // Updated color to match light mode muted text
            document.getElementById('demandList').innerHTML = '<p style="color: #6c757d; font-style: italic;">Select a by-product to view demand sources</p>';
            drawEmptyChart();
        }

        // Draw empty chart (Color updated for light mode)
        function drawEmptyChart() {
            const canvas = document.getElementById('priceChart');
            const ctx = canvas.getContext('2d');
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            
            // Light background
            ctx.fillStyle = LM_CHART_BG; 
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Muted text
            ctx.fillStyle = LM_LABEL_COLOR; 
            ctx.font = '16px Segoe UI';
            ctx.textAlign = 'center';
            ctx.fillText('Select an oilseed and by-product to view chart', canvas.width / 2, canvas.height / 2);
        }

        // Update chart (Colors updated for light mode)
        function updateChart() {
            const canvas = document.getElementById('priceChart');
            const ctx = canvas.getContext('2d');
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            
            const padding = 60;
            const chartWidth = canvas.width - padding * 2;
            const chartHeight = canvas.height - padding * 2;
            
            // Clear canvas to light mode background color
            ctx.fillStyle = LM_CHART_BG;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Get data based on chart type
            let dataPoints;
            let label;
            let color;
            
            switch(currentChartType) {
                case 'demand':
                    dataPoints = historicalData.map(d => d.demand);
                    label = 'Demand (%)';
                    color = '#ffc107'; // Yellow/Orange
                    break;
                case 'supply':
                    dataPoints = historicalData.map(d => d.supply);
                    label = 'Supply (%)';
                    color = '#17a2b8'; // Cyan/Teal
                    break;
                default:
                    dataPoints = historicalData.map(d => d.price);
                    label = 'Price (â‚¹/Quintal)';
                    color = '#007BFF'; // Primary Blue
            }
            
            const maxValue = Math.max(...dataPoints);
            const minValue = Math.min(...dataPoints);
            // Added a small epsilon to valueRange to prevent division by zero if all values are identical
            const valueRange = maxValue - minValue || 0.1; 
            
            // Draw grid lines
            ctx.strokeStyle = LM_GRID_COLOR;
            ctx.lineWidth = 1;
            for (let i = 0; i <= 5; i++) {
                const y = padding + (chartHeight / 5) * i;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(canvas.width - padding, y);
                ctx.stroke();
                
                // Y-axis labels
                const value = maxValue - (valueRange / 5) * i;
                ctx.fillStyle = LM_LABEL_COLOR;
                ctx.font = '12px Segoe UI';
                ctx.textAlign = 'right';
                ctx.fillText(Math.round(value), padding - 10, y + 4);
            }
            
            // Draw chart line
            ctx.strokeStyle = color;
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            dataPoints.forEach((value, index) => {
                const x = padding + (chartWidth / (dataPoints.length - 1)) * index;
                const y = padding + chartHeight - ((value - minValue) / valueRange) * chartHeight;
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            
            ctx.stroke();
            
            // Draw data points
            ctx.fillStyle = color;
            dataPoints.forEach((value, index) => {
                const x = padding + (chartWidth / (dataPoints.length - 1)) * index;
                const y = padding + chartHeight - ((value - minValue) / valueRange) * chartHeight;
                
                ctx.beginPath();
                ctx.arc(x, y, 4, 0, Math.PI * 2);
                ctx.fill();
            });
            
            // Draw X-axis labels (every 5 days)
            ctx.fillStyle = LM_LABEL_COLOR;
            ctx.font = '11px Segoe UI';
            ctx.textAlign = 'center';
            for (let i = 0; i < historicalData.length; i += 5) {
                const x = padding + (chartWidth / (dataPoints.length - 1)) * i;
                ctx.fillText(historicalData[i].date, x, canvas.height - padding + 20);
            }
            
            // Draw Y-axis label
            ctx.save();
            ctx.translate(20, canvas.height / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillStyle = color; // Use the line color for the label
            ctx.font = 'bold 14px Segoe UI';
            ctx.textAlign = 'center';
            ctx.fillText(label, 0, 0);
            ctx.restore();
            
            // Draw title
            ctx.fillStyle = LM_TITLE_COLOR;
            ctx.font = 'bold 16px Segoe UI';
            ctx.textAlign = 'center';
            ctx.fillText(`${selectedOilseed} - ${selectedByproduct}`, canvas.width / 2, 30);
        }

        // Initialize on page load (Same logic)
        window.addEventListener('load', init);
        window.addEventListener('resize', () => {
            if (selectedOilseed && selectedByproduct) {
                updateChart();
            } else {
                drawEmptyChart();
            }
        });
    </script>
</body>
</html>